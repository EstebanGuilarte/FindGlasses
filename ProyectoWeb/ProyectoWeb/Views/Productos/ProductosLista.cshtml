@model IEnumerable<ProyectoWeb.Entities.ProductosEnt>

@{
    ViewData["Title"] = "ProductosLista";
    Layout = "~/Views/Shared/_Layout_ProductosLista.cshtml";
}

<div class="row w-100 mx-0 col-lg-4">
    <h1>Lista de Productos</h1>
</div>

<br />
<div class="mt-3 row w-100 mx-0 col-lg-4">
    <a class="btn btn-dark text-white rounded" href="@Url.Action("RegistrarProducto", "Productos")">Agregar</a>
</div>
<br />
<div class="content-wrapper d-flex align-items-center auth px-0">
    <div class="row w-100 mx-0 col-lg-12">
        <table class="table">
            <thead class="thead-dark">
                <tr>
                    <th>Id Producto</th>
                    <th>Nombre Producto</th>
                    <th>Descripción</th>
                    <th>Precio</th>
                    <th>Cantidad Stock</th>
                    <th>Marca</th>
                    <th>Tipo Producto</th>
                    <th>Actualizar</th>
                    <th>Eliminar</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var producto in Model)
                {
                    <tr>
                        <td>@producto.IdProducto</td>
                        <td>@producto.nombreProducto</td>
                        <td>@producto.descripcion</td>
                        <td>@producto.precio</td>
                        <td>@producto.cantidadStock</td>
                        <td>@producto.marca</td>
                        <td>@producto.tipoProducto</td>
                        <td>
                            <a class="btn btn-dark btn-sm text-white rounded" href="@Url.Action("ActualizarProducto", "Productos", new { id = producto.IdProducto })">Actualizar</a>
                        </td>
                        <td>
                            <button class="btn btn-dark btn-sm text-white rounded" onclick="eliminarProducto(@producto.IdProducto)">Eliminar</button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!-- Agregar este script por aparte después -->
@section scripts {
    <script>
        function eliminarProducto(id) {
            if (confirm("¿Estás seguro de que deseas eliminar este producto?")) {

                $.ajax({
                    url: '@Url.Action("EliminarProducto", "Productos")/' + id,
                    type: 'DELETE',
                    success: function (data) {
                        alert(data);
                        location.reload();
                    },
                    error: function () {
                        alert('Error al intentar eliminar el producto.');
                    }
                });
            }
        }
    </script>
}

